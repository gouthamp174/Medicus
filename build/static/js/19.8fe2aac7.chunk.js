(this.webpackJsonpmedicus=this.webpackJsonpmedicus||[]).push([[19],{146:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var a=n(12),c=n.n(a),r=n(11),s=n(52),o=n(14),i=n(8),l=n(0),j=n(3),u=n(19),d=n(51),p=n(32),b=n(50),h=n(24),m=n(1);function f(e){var t=Object(l.useState)(""),n=Object(i.a)(t,2),a=n[0],s=n[1],j=Object(l.useState)({title:"",content:""}),u=Object(i.a)(j,2),d=u[0],f=u[1];function O(e){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(Object(r.a)(Object(r.a)({},d),{},Object(p.a)({},t.target.name,t.target.value)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return(v=Object(o.a)(c.a.mark((function t(n){var a,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,a={fromUsername:Object(h.o)({user:e.session}),title:d.title,content:d.content,date:new Date},t.next=5,fetch("/api/appointments/".concat(e.appointment.id,"/notes"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.session.authToken)},body:JSON.stringify(a)});case 5:return o=t.sent,t.next=8,o.json();case 8:if(i=t.sent,o.ok){t.next=11;break}throw new Error(i.message);case 11:a.id=i.id,e.appendNote&&e.appendNote(a),f(Object(r.a)(Object(r.a)({},d),{},{title:"",content:""})),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(1),console.error("Failed to add new note. ".concat(t.t0)),s(t.t0.message);case 20:case"end":return t.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}return Object(m.jsxs)(b.a,{className:"container-fluid",handleSubmit:function(e){return v.apply(this,arguments)},children:[a&&Object(m.jsx)(b.f,{className:"justify-content-center",children:Object(m.jsx)("div",{className:"alert alert-danger",role:"alert",children:a})}),Object(m.jsxs)(b.f,{className:"my-2",children:[Object(m.jsx)(b.d,{for:"noteWidget1",className:"col-sm-4",children:"Title"}),Object(m.jsx)(b.c,{className:"col-sm-8",children:Object(m.jsx)("input",{id:"noteWidget1",type:"text",name:"title",className:"form-control",value:d.title,onChange:O,placeholder:"Add new title"})})]}),Object(m.jsxs)(b.f,{className:"my-2",children:[Object(m.jsx)(b.d,{for:"noteWidget2",className:"col-sm-4",children:"Content"}),Object(m.jsx)(b.c,{className:"col-sm-8",children:Object(m.jsx)("textarea",{id:"noteWidget2",type:"text",name:"content",className:"form-control",value:d.content,onChange:O,placeholder:"Add new content",rows:"3"})})]}),Object(m.jsx)(b.f,{className:"my-2 justify-content-center",children:Object(m.jsx)(b.g,{className:"col-auto col-md-4",children:"Add"})})]})}var O=n(33),x=n(13);function v(e){return Object(m.jsx)(d.l,{children:Object(m.jsx)(x.e,{children:Object(m.jsx)(x.g,{children:Object(m.jsx)(x.a,{className:"md-font-sm text-center text-muted",children:"No note available"})})})})}function y(e){function t(){return(t=Object(o.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),e.handleDelete&&e.handleDelete(e.note.id);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var n=e.note.fromUsername,a=Object(h.o)({user:e.session})===n,r=new Date(e.note.date);return Object(m.jsx)(d.l,{children:Object(m.jsx)(x.e,{children:Object(m.jsxs)(x.g,{children:[Object(m.jsxs)(x.a,{className:"align-self-center",children:[Object(m.jsxs)(x.g,{children:[Object(m.jsx)(x.a,{className:"text-truncate",children:e.note.title}),Object(m.jsx)(x.a,{className:"col-auto",children:Object(m.jsx)(O.e,{date:r})})]}),Object(m.jsx)(x.g,{children:Object(m.jsx)(x.a,{className:"text-truncate",children:e.note.content})})]}),Object(m.jsx)(x.a,{className:"col-auto px-2",children:a&&Object(m.jsx)(d.i,{children:Object(m.jsx)(d.j,{handleClick:function(e){return t.apply(this,arguments)},children:"Delete"})})})]})})})}function g(e){return Object(m.jsx)(d.k,{children:0!==e.notes.length?Object(m.jsx)(m.Fragment,{children:e.notes.map((function(t,n){return Object(m.jsx)(y,{session:e.session,note:t,handleDelete:e.deleteNote},n)}))}):Object(m.jsx)(v,{})})}function w(e){var t=Object(l.useState)({notes:[],limit:10}),n=Object(i.a)(t,2),a=n[0],p=n[1];function b(){return(b=Object(o.a)(c.a.mark((function t(){var n,o,i,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n="/api/appointments/".concat(e.appointment.id,"/notes"),(o=new URLSearchParams).append("page",Math.ceil(a.notes.length/a.limit)),o.append("limit",a.limit),t.next=7,fetch("".concat(n,"?").concat(o.toString()),{headers:{Authorization:"Bearer ".concat(e.session.authToken)}});case 7:return i=t.sent,t.next=10,i.json();case 10:if(l=t.sent,i.ok){t.next=13;break}throw new Error(l.message);case 13:p((function(e){var t=[].concat(Object(s.a)(e.notes),Object(s.a)(l));return Object(r.a)(Object(r.a)({},e),{},{notes:t})})),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Failed to append more notes. ".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))).apply(this,arguments)}function h(){return(h=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p((function(e){var n=[t].concat(Object(s.a)(e.notes));return Object(r.a)(Object(r.a)({},e),{},{notes:n})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(o.a)(c.a.mark((function t(n){var s,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/api/appointments/".concat(e.appointment.id,"/notes/").concat(n),{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.session.authToken)}});case 3:return s=t.sent,t.next=6,s.json();case 6:if(o=t.sent,s.ok){t.next=9;break}throw new Error(o.message);case 9:p((function(e){var t=a.notes.filter((function(e){return e.id!==n}));return Object(r.a)(Object(r.a)({},e),{},{notes:t})})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Failed to delete note- ".concat(n,". ").concat(t.t0));case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}var x=Object(j.a)(e.session,e.appointment.physician);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(d.e,{children:[Object(m.jsx)(d.a,{title:"Notes",children:x&&Object(m.jsx)(d.d,{target:"apptNoteAdd01",expandIcon:"add",collapseIcon:"clear"})}),Object(m.jsx)(d.g,{id:"apptNoteAdd01",children:Object(m.jsx)(f,{session:e.session,appointment:e.appointment,appendNote:function(e){return h.apply(this,arguments)}})}),Object(m.jsx)(g,{session:e.session,notes:a.notes,deleteNote:function(e){return O.apply(this,arguments)}})]}),Object(m.jsx)(u.a,{callback:function(){return b.apply(this,arguments)}})]})}},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(25);var c=n(21);function r(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=19.8fe2aac7.chunk.js.map
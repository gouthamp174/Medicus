(this.webpackJsonpmedicus=this.webpackJsonpmedicus||[]).push([[15],{52:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(24);var c=n(20);function r(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},71:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(52),c=n(11),r=n(12),s=n.n(r),i=n(13),o=n(9),u=n(14),p=n(0),l=n(19),j=n(33),h=n(17),d=n(56),m=n(31),b=n(75),f=n(1);function O(e){return Object(f.jsx)(h.e,{className:"md-appt-date p-3",children:Object(f.jsx)(h.g,{className:"justify-content-center",children:Object(f.jsx)(h.a,{className:"col-auto align-items-center",children:Object(f.jsx)("h6",{className:"my-0",children:Object(f.jsx)(j.g,{date:e.date,long:!0})})})})})}function v(e){return Object(f.jsx)(h.g,{className:"justify-content-center",children:Object(f.jsx)(h.a,{className:"col-auto align-items-center",children:Object(f.jsx)("h6",{className:"my-0 py-3 text-muted",children:e.message})})})}function x(e){var t,n=new Map,a=Object(u.a)(e.appointments);try{for(a.s();!(t=a.n()).done;){var c=t.value,r=new Date(c.startTime).toDateString();n.has(r)||n.set(r,[]),n.get(r).push(c)}}catch(g){a.e(g)}finally{a.f()}var s=[];if(n.size>0){var i,p=Object(u.a)(n.entries());try{for(p.s();!(i=p.n()).done;){var l=Object(o.a)(i.value,2),j=l[0],m=l[1],x=new Date(j),w=Object(f.jsx)(h.g,{children:Object(f.jsxs)(h.a,{className:"px-0",children:[Object(f.jsx)(O,{date:x}),Object(f.jsx)(d.a,{className:"md-list",children:m.map((function(t,n){return Object(f.jsx)(d.c,{className:"p-0 my-1",children:Object(f.jsx)(b.a,{session:e.session,id:t.id,deleteAppointment:e.deleteAppointment,listView:!0})},n)}))})]})});s.push(w)}}catch(g){p.e(g)}finally{p.f()}}else s.push(Object(f.jsx)(v,{message:e.defaultMessage}));return Object(f.jsx)(h.e,{children:s})}function w(e){var t=Object(l.c)((function(e){return e.session})),n=Object(p.useCallback)(function(){var e=Object(i.a)(s.a.mark((function e(n){var a,c,r,i,o,u,p,l,j,h,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.view,c=void 0===a?"":a,r=n.search,i=void 0===r?"":r,o=n.page,u=void 0===o?0:o,p=n.limit,l=void 0===p?10:p,e.prev=1,j=new URLSearchParams,c&&j.append("view",c),i&&j.append("search",i),j.append("page",u),j.append("limit",l),e.next=9,fetch("/api/appointments?".concat(j.toString()),{headers:{Authorization:"Bearer ".concat(t.authToken)}});case 9:return h=e.sent,e.next=12,h.json();case 12:if(d=e.sent,h.ok){e.next=15;break}throw new Error(d.message);case 15:return e.abrupt("return",d);case 18:throw e.prev=18,e.t0=e.catch(1),e.t0;case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),[t.authToken]),r=Object(p.useState)({appointments:[],limit:10}),u=Object(o.a)(r,2),j=u[0],d=u[1];function b(){return(b=Object(i.a)(s.a.mark((function t(){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({view:e.view,search:e.search,page:Math.ceil(j.appointments.length/j.limit),limit:j.limit});case 3:r=t.sent,d((function(e){var t=[].concat(Object(a.a)(e.appointments),Object(a.a)(r));return Object(c.a)(Object(c.a)({},e),{},{appointments:t})})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to append more appointments. ".concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function O(){return(O=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{d((function(e){var n=e.appointments.filter((function(e){return e.id!==t}));return Object(c.a)(Object(c.a)({},e),{},{appointments:n})}))}catch(n){console.error("Failed to delete appointment- ".concat(t,". ").concat(n))}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(p.useEffect)((function(){function t(){return(t=Object(i.a)(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({view:e.view,search:e.search,page:0,limit:j.limit});case 3:a=t.sent,d((function(e){return Object(c.a)(Object(c.a)({},e),{},{appointments:a})})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to load appointments. ".concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.view,e.search,n,j.limit]),Object(f.jsx)(h.e,{children:Object(f.jsx)(h.g,{children:Object(f.jsxs)(h.a,{className:"px-0",children:[Object(f.jsx)(x,{session:t,appointments:j.appointments,deleteAppointment:function(e){return O.apply(this,arguments)},defaultMessage:e.defaultMessage}),j.appointments.length>0&&Object(f.jsx)(m.a,{callback:function(){return b.apply(this,arguments)}})]})})})}},98:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var a=n(9),c=n(0),r=n(19),s=n(17),i=n(55),o=n(71),u=n(1);function p(e){var t=Object(r.c)((function(e){return e.session})),n=Object(c.useState)(""),p=Object(a.a)(n,2),l=p[0],j=p[1],h=!Boolean(t.isPhysician);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)(i.d,{title:"Waiting Room",children:[Object(u.jsx)(i.c,{handleSearch:j,placeholder:"Search appointments..."}),Object(u.jsx)(i.b,{children:h&&Object(u.jsx)(i.a,{path:"/appointments?view=new",title:"New Appointment",icon:"add"})})]}),Object(u.jsx)(s.g,{className:"flex-grow-1",children:Object(u.jsx)(s.a,{children:Object(u.jsx)(o.a,{view:"waiting",search:l,defaultMessage:"Hurray! You've caught up with all your appointments."})})})]})}}}]);
//# sourceMappingURL=15.c175d0ae.chunk.js.map